---
title: "Data Analysis"
output: html_document
---


```{r load-packages, message=FALSE}
library(tidyverse)
library(broom)
library(readr)
```


```{r upload-data}
Summer_olympics <- read_csv("Summer-Olympic-medals-1976-to-2008.csv")
Country_codes <- read_csv("coutry-and-continent-codes.csv")
```

```{r augmenting-data}
#names(Country_codes)[names(Country_codes) == 'Three_Letter_Country_Code'] <- 'Country_code'
Olympic_final <- Summer_olympics %>%
   left_join(
      Country_codes, 
      by = c("Country_Code" = "Three_Letter_Country_Code") ) %>%
   mutate(
      Medal_value = case_when(
      Medal == "Gold" ~ 3,
      Medal == "Silver" ~ 2,
      Medal == "Bronze" ~ 1)) %>%
   filter(Year == c(1996, 2000, 2004, 2008))
```

```{r NA_graph}
Olympic_final %>%
   filter(Continent_Name == "North America") %>%
  ggplot(aes(x = Country, y = Medal_value, fill=Medal)) +
  geom_col()  +
  facet_wrap(~ "Continent_Name")
```


```{r UK_aquatics}
Olympic_final %>%
   filter(Sport == "Aquatics") %>%
   filter(Country == "United Kingdom") %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Count for Aquatics for United Kingdom") +
   geom_col() +
   axis(at = seq(1996,2008, by = 4))
   
```

```{r France_Aquatics}
Olympic_final %>%
   filter(Sport == "Aquatics") %>%
   filter(Country == "France") %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Count for Aquatics for France") +
   geom_col() +
   axis(at = seq(1996,2008, by = 4))
```



```{r France_UK_graph_Total_Medals}
Olympic_aquatics %>%
   filter(Country == c("France", "United Kingdom")) %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Value for France and UK") +
   geom_col() +
   facet_wrap(~ Country)
```




```{r summarising-medals}
#Creating Bronze, Silver, and Gold columns and removing excess
Olympic_collapse <- Olympic_final %>%
  group_by(Country) %>%
  mutate(
  Bronze = sum(str_count(Medal, "Bronze")),
  Silver = sum(str_count(Medal, "Silver")),
  Gold = sum(str_count(Medal, "Gold"))) %>%
  select(Country, Medal) %>%
  group_by(Country, Medal) %>%
  count() %>%
  pivot_wider(names_from = Medal, values_from = n) %>%
  mutate_all(~replace(., is.na(.), 0))
```


## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
