---
title: "Data Analysis"
output: html_document
---


```{r load-packages, message=FALSE}
library(tidyverse)
library(broom)
library(readr)
```


```{r upload-data}
Summer_olympics <- read_csv("Summer-Olympic-medals-1976-to-2008.csv")
Country_codes <- read_csv("coutry-and-continent-codes.csv")
gdp_data <- read_csv("gdp_data.csv")
```

```{r augmenting-data}
#names(Country_codes)[names(Country_codes) == 'Three_Letter_Country_Code'] <- 'Country_code'
Olympic_final <- Summer_olympics %>%
   left_join(
      Country_codes, 
      by = c("Country_Code" = "Three_Letter_Country_Code") ) %>%
   mutate(
      Medal_value = case_when(
      Medal == "Gold" ~ 3,
      Medal == "Silver" ~ 2,
      Medal == "Bronze" ~ 1)) %>%
   filter(Year == c(1996, 2000, 2004, 2008))
```

```{r summarising-medals}
#Creating Bronze, Silver, and Gold columns and removing excess
Olympic_collapse <- Olympic_final %>%
  group_by(Country) %>%
  mutate(
  Bronze = sum(str_count(Medal, "Bronze")),
  Silver = sum(str_count(Medal, "Silver")),
  Gold = sum(str_count(Medal, "Gold"))) %>%
  select(Country, Medal, Continent_Name) %>%
  group_by(Country, Medal) %>%
  mutate(Continent_Name = case_when(
      Country %in% c("Germany", "Netherlands", "Yugoslavia", "Bulgaria",
                     "Switzerland", "Slovenia", "Denmark", "Croatia", "Greece",
                     "Portugal", "Serbia", "Latvia") ~ "Europe",
      Country %in% c("Bahamas", "Costa Rica") ~ "North America",
      Country %in% c("Trinidad and Tobago", "Chile") ~ "South America",
      Country %in% c("Indonesia", "Taiwan", "Vietnam", "Iran",  "Malaysia",
                     "Mongolia") ~ "Asia",
      Country %in% c("Zimbabwe", "Nigeria") ~ "Africa",  
       TRUE    ~ Continent_Name)) %>%
  count() %>%
  pivot_wider(names_from = Medal, values_from = n) %>%
  mutate_all(~replace(., is.na(.), 0))
```

```{r NA_graph}
Olympic_final %>%
   filter(Continent_Name == "North America") %>%
  ggplot(aes(x = Country, y = Medal_value, fill=Medal)) +
  geom_col()  +
  facet_wrap(~ "Continent_Name")
```

```{r Russia_US_graph_Total_Medals}
Olympic_final %>%
   filter(Country == c("United States", "Russia")) %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Value for USA and Russia") +
   geom_col() +
   facet_wrap(~ Country)
```

```{r US_aquatics}
Olympic_final %>%
   filter(Sport == "Aquatics") %>%
   filter(Country == "United States") %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Count for Aquatics for the United States") +
   geom_col() +
   scale_x_continuous(breaks = seq(1996,2008, by = 4), labels = c("1996", "2000", "2004", "2008"))
   
```

```{r China_Aquatics}
Olympic_final %>%
   filter(Sport == "Aquatics") %>%
   filter(Country == "Russia") %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Count for Aquatics for Russia") +
   geom_col() +
   scale_x_continuous(breaks = seq(1996,2008, by = 4), labels = c("1996", "2000", "2004", "2008"))
  
```

```{r US_athletics}
Olympic_final %>%
   filter(Sport == "Athletics") %>%
   filter(Country == "United States") %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Count for Athletics for the United States") +
   geom_col() +
   scale_x_continuous(breaks = seq(1996,2008, by = 4), labels = c("1996", "2000", "2004", "2008"))

```

```{r Jamaica_athletics}
Olympic_final %>%
   filter(Sport == "Athletics") %>%
   filter(Country == "Jamaica") %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Count for Athletics for Jamaica") +
   geom_col() +
   scale_x_continuous(breaks = seq(1996,2008, by = 4), labels = c("1996", "2000", "2004", "2008"))
```

```{r US_Rowing}
Olympic_final %>%
   filter(Sport == "Rowing") %>%
   filter(Country == "United States") %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Count for Rowing for the United States") +
   geom_col() +
   scale_x_continuous(breaks = seq(1996,2008, by = 4), labels = c("1996", "2000", "2004", "2008"))

```


```{r UK_Rowing}
Olympic_final %>%
   filter(Sport == "Rowing") %>%
   filter(Country == "United Kingdom") %>%
   ggplot(aes(x = Year, y = Medal_value, fill = Medal)) + 
   labs(x = "Year", y = "Total Medal Values", 
   title = "Total Medal Count for Rowing for the United Kingdom") +
   geom_col() +
   scale_x_continuous(breaks = seq(1996,2008, by = 4), labels = c("1996", "2000", "2004", "2008"))
```

```{r gdp}
gdp_data %>%
   filter(Year == "1998") %>%
   View
```

```
